<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HEALTCH LAB KZ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    
    <style>
        /* --- GLOBAL & THEMING --- */
        :root {
            /* Default: Deep Space */
            --bg-body: linear-gradient(135deg, #0f1115 0%, #131426 50%, #1e1b4b 100%);
            --glass-bg: rgba(255, 255, 255, 0.07);
            --glass-border: 1px solid rgba(255, 255, 255, 0.12);
            --text-main: #ffffff;
            --text-muted: #9ca3af;
            --card-hover: rgba(255, 255, 255, 0.08);
            --nav-bg: rgba(20, 20, 30, 0.8);
            --primary-grad: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            --nav-height: 70px;
        }

        /* Theme: Pure White */
        [data-theme="white"] {
            --bg-body: #f8fafc;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: 1px solid rgba(0, 0, 0, 0.05);
            --text-main: #1e293b;
            --text-muted: #64748b;
            --card-hover: rgba(0, 0, 0, 0.03);
            --nav-bg: rgba(255, 255, 255, 0.9);
            --primary-grad: linear-gradient(135deg, #3b82f6 0%, #0ea5e9 100%);
        }
        
        /* Theme: Onyx Mono */
        [data-theme="onyx"] {
            --bg-body: linear-gradient(180deg, #000000 0%, #1a1a1a 100%);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
            --text-main: #e5e5e5;
            --text-muted: #737373;
            --card-hover: rgba(255, 255, 255, 0.1);
            --nav-bg: rgba(0, 0, 0, 0.8);
            --primary-grad: linear-gradient(135deg, #ffffff 0%, #999999 100%);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: var(--nav-height);
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* Text color overrides for themes */
        [data-theme="white"] .text-gray-400, 
        [data-theme="white"] .text-gray-300,
        [data-theme="white"] .text-gray-500 { color: var(--text-muted); }
        [data-theme="white"] .text-white { color: var(--text-main); }

        .font-serif-display { font-family: 'Playfair Display', serif; }

        .glass-panel {
            background: var(--nav-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-top: var(--glass-border);
            box-shadow: 0 -4px 30px rgba(0, 0, 0, 0.1);
        }
        
        .glass-header {
             background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-bottom: var(--glass-border);
             box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: var(--glass-border);
            border-radius: 16px;
            padding: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        .glass-card:active {
            transform: scale(0.98);
            background: var(--card-hover);
        }

        /* --- PREMIUM ICONS & ANIMATIONS --- */
        .icon-box {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .icon-box::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 100%);
            opacity: 0.3;
        }
        
        /* Live Heart Special */
        .heart-live {
            background: radial-gradient(circle at center, #ef4444 0%, #7f1d1d 100%);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.6);
            animation: heartbeat 1.5s infinite;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes heartbeat { 0% { transform: scale(1); box-shadow: 0 0 20px rgba(239, 68, 68, 0.4); } 15% { transform: scale(1.1); box-shadow: 0 0 30px rgba(239, 68, 68, 0.8); } 30% { transform: scale(1); box-shadow: 0 0 20px rgba(239, 68, 68, 0.4); } 45% { transform: scale(1.1); box-shadow: 0 0 30px rgba(239, 68, 68, 0.8); } 60% { transform: scale(1); box-shadow: 0 0 20px rgba(239, 68, 68, 0.4); } }
        @keyframes scanline { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulse-glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .animate-scan { animation: scanline 2s linear infinite; }
        .animate-spin-slow { animation: spin-slow 3s linear infinite; }
        .animate-pulse-glow { animation: pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: rgba(150,150,150,0.3); border-radius: 4px; }

        /* Inputs & Buttons */
        .glass-input {
            background: rgba(0, 0, 0, 0.1); /* Darker for input visibility in light mode */
            border: var(--glass-border);
            color: var(--text-main);
            padding: 12px 16px;
            border-radius: 12px;
            width: 100%;
            outline: none;
        }
        [data-theme="white"] .glass-input { background: rgba(255,255,255,0.8); border: 1px solid #e2e8f0; color: #1e293b; }
        .glass-input:focus { border-color: #8b5cf6; }

        .btn-primary {
            background: var(--primary-grad);
            color: white; /* Always white for primary btn */
            font-weight: 600;
            padding: 14px;
            border-radius: 12px;
            text-align: center;
            width: 100%;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        [data-theme="onyx"] .btn-primary { color: #000; }
        .btn-primary:active { transform: scale(0.97); }

        /* Toast Notification */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: rgba(16, 185, 129, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 100;
            left: 50%;
            bottom: 90px;
            transform: translateX(-50%);
            font-size: 14px;
            backdrop-filter: blur(4px);
        }
        #toast.show { visibility: visible; animation: fadeIn 0.5s, fadeOut 0.5s 2.5s; }
        @keyframes fadeOut { from {bottom: 90px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        /* Switch Toggle */
        .switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4b5563; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #22c55e; }
        input:checked + .slider:before { transform: translateX(18px); }
        
        /* Utility for Text Area in Diary */
        .diary-textarea {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--text-main);
            resize: none;
            outline: none;
            font-size: 14px;
            min-height: 60px;
        }
        
        /* ElevenLabs Widget Styling Container */
        elevenlabs-convai {
            width: 100%;
            display: block;
            min-height: 150px;
        }

        /* Bottom Nav specific styles */
        .nav-btn {
            transition: all 0.3s ease;
            opacity: 0.6;
            color: var(--text-muted);
        }
        .nav-btn.active {
            opacity: 1;
            color: #3b82f6;
        }
        [data-theme="onyx"] .nav-btn.active { color: #fff; }

        .pb-safe { padding-bottom: env(safe-area-inset-bottom, 16px); }
        
        /* Theme Selection Cards */
        .theme-card {
            border: 2px solid transparent;
            cursor: pointer;
        }
        .theme-card.active-theme {
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="antialiased text-gray-100">

    <div id="toast"></div>

    <div id="app" class="max-w-md mx-auto min-h-screen relative overflow-hidden">
        
        <section id="screen-welcome" class="flex flex-col justify-center min-h-screen p-6 animate-fade-in relative z-10">
            <div class="mb-10 text-center">
                <h1 class="text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400 mb-2">
                    HEALTCH <br> LAB KZ
                </h1>
                <p class="text-gray-400 text-sm">–í–∞—à–µ –∑–¥–æ—Ä–æ–≤—å–µ ‚Äî –Ω–∞—à –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</p>
            </div>
            <div class="space-y-4">
                <input type="email" id="login-email" class="glass-input" placeholder="Email" value="admin@gmail.com">
                <input type="password" id="login-pass" class="glass-input" placeholder="–ü–∞—Ä–æ–ª—å" value="admin123">
                <button onclick="handleLogin()" class="btn-primary mt-4">–í–æ–π—Ç–∏</button>
                <button onclick="alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã—Ç–∞')" class="w-full text-center text-sm text-gray-400 mt-4">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</button>
            </div>
        </section>

        <div id="bottom-nav" class="hidden fixed bottom-0 left-0 right-0 glass-panel z-50 max-w-md mx-auto">
            <div class="flex justify-around items-center p-2 pb-safe font-medium">
                <button onclick="switchTab('screen-analyses', this)" class="nav-btn flex flex-col items-center gap-1 active" id="default-tab-btn">
                    <i data-lucide="flask-conical" class="w-6 h-6"></i>
                    <span class="text-[10px]">–ú–æ–∏ –∞–Ω–∞–ª–∏–∑—ã</span>
                </button>
                <button onclick="switchTab('screen-health', this)" class="nav-btn flex flex-col items-center gap-1">
                    <i data-lucide="heart" class="w-6 h-6"></i>
                    <span class="text-[10px]">–ó–¥–æ—Ä–æ–≤—å–µ</span>
                </button>
                 <button onclick="switchTab('screen-workouts', this)" class="nav-btn flex flex-col items-center gap-1">
                    <i data-lucide="dumbbell" class="w-6 h-6"></i>
                    <span class="text-[10px]">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</span>
                </button>
                 <button onclick="switchTab('screen-nutrition', this)" class="nav-btn flex flex-col items-center gap-1">
                    <i data-lucide="apple" class="w-6 h-6"></i>
                    <span class="text-[10px]">–ü–∏—Ç–∞–Ω–∏–µ</span>
                </button>
                <button onclick="switchTab('screen-settings', this)" class="nav-btn flex flex-col items-center gap-1">
                    <i data-lucide="settings" class="w-6 h-6"></i>
                    <span class="text-[10px]">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </button>
            </div>
        </div>

        <section id="screen-analyses" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
            <div class="flex justify-between items-center mb-6 mt-2">
                <div>
                    <p class="text-sm text-gray-400">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å,</p>
                    <h2 class="text-xl font-bold">Admin</h2>
                </div>
                <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold shadow-lg">A</div>
            </div>

            <div onclick="navigateTo('screen-laboratories')" class="glass-card mb-4 flex items-center justify-between p-4 cursor-pointer active:scale-98 bg-gradient-to-r from-blue-900/40 to-purple-900/40 border-blue-500/20">
                <div class="flex items-center gap-3">
                    <div class="p-2 bg-blue-500 rounded-lg text-white shadow-lg shadow-blue-500/30">
                        <i data-lucide="building-2" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-sm">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏</h3>
                        <p class="text-[10px] text-gray-400">–ó–∞–ø–∏—Å—å –∏ –∫–∞—Ä—Ç–∞</p>
                    </div>
                </div>
                <i data-lucide="chevron-right" class="w-5 h-5 text-gray-500"></i>
            </div>

            <div class="grid grid-cols-2 gap-2 mb-6">
                 <div onclick="navigateTo('screen-upcoming')" class="glass-card flex flex-col items-center justify-center p-3 cursor-pointer active:scale-95">
                    <div class="icon-box w-10 h-10 bg-orange-500/20 text-orange-400 mb-2">
                        <i data-lucide="calendar-clock" class="w-5 h-5"></i>
                    </div>
                    <span class="text-[10px] text-center font-semibold">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ<br>–∞–Ω–∞–ª–∏–∑—ã</span>
                </div>
                 <div onclick="navigateTo('screen-voice-analysis')" class="glass-card flex flex-col items-center justify-center p-3 cursor-pointer active:scale-95">
                    <div class="icon-box w-10 h-10 bg-blue-500/20 text-blue-400 mb-2">
                        <i data-lucide="sparkles" class="w-5 h-5"></i>
                    </div>
                    <span class="text-[10px] text-center font-semibold">–†–∞–∑–±–æ—Ä<br>–∞–Ω–∞–ª–∏–∑–æ–≤</span>
                </div>
            </div>
            
            <div class="mb-4 flex justify-between items-center">
                 <h2 class="font-bold text-lg">–ë–∏–æ–º–∞—Ä–∫–µ—Ä—ã</h2>
            </div>
            
            <p class="text-xs text-gray-400 mb-4 uppercase font-bold tracking-wider">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
            <div class="grid grid-cols-2 gap-3" id="categories-grid">
                </div>
        </section>

        <section id="screen-settings" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
            <h2 class="font-bold text-lg mb-6 mt-2">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="mb-8">
                <h3 class="text-xs text-gray-400 uppercase font-bold tracking-wider mb-4">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h3>
                <div class="space-y-3">
                    <div onclick="applyTheme('default')" class="glass-card theme-card active-theme flex items-center gap-3 p-3" id="theme-default">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-900 to-purple-900 border border-white/20"></div>
                        <div class="flex-1">
                            <h4 class="text-sm font-bold">Deep Space</h4>
                            <p class="text-[10px] text-gray-400">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</p>
                        </div>
                    </div>
                    <div onclick="applyTheme('white')" class="glass-card theme-card flex items-center gap-3 p-3" id="theme-white">
                        <div class="w-8 h-8 rounded-full bg-slate-100 border border-gray-300"></div>
                        <div class="flex-1">
                            <h4 class="text-sm font-bold">Pure White</h4>
                            <p class="text-[10px] text-gray-400">–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞</p>
                        </div>
                    </div>
                    <div onclick="applyTheme('onyx')" class="glass-card theme-card flex items-center gap-3 p-3" id="theme-onyx">
                        <div class="w-8 h-8 rounded-full bg-black border border-gray-700"></div>
                        <div class="flex-1">
                            <h4 class="text-sm font-bold">Onyx Mono</h4>
                            <p class="text-[10px] text-gray-400">Noir —Å—Ç–∏–ª—å</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-xs text-gray-400 uppercase font-bold tracking-wider mb-4">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h3>
                <div onclick="navigateTo('screen-devices')" class="glass-card flex items-center justify-between p-4 cursor-pointer hover:bg-white/5">
                    <div class="flex items-center gap-3">
                        <div class="p-2 bg-green-500/20 rounded-lg text-green-400">
                            <i data-lucide="watch" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-sm">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h3>
                            <p class="text-[10px] text-gray-400">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—Ä–∞—Å–ª–µ—Ç–æ–≤</p>
                        </div>
                    </div>
                    <i data-lucide="chevron-right" class="w-5 h-5 text-gray-500"></i>
                </div>
            </div>
            
             <div class="glass-card flex items-center justify-between p-4 opacity-50">
                <span class="text-sm">–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
                <span class="text-xs font-mono text-gray-500">v2.0.4 (Beta)</span>
            </div>
        </section>

        <section id="screen-health" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
             <div class="mb-6 mt-2 flex items-center justify-between">
                <h2 class="font-bold text-lg">–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∑–¥–æ—Ä–æ–≤—å—è</h2>
                 <div class="flex items-center gap-2">
                     <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                     <span class="text-xs text-gray-400">Live (–ß–∞—Å—ã)</span>
                 </div>
            </div>

            <div class="space-y-4">
                <div class="glass-card p-0 overflow-hidden bg-opacity-20 border-red-500/20">
                    <div class="flex flex-col items-center py-8">
                         <div class="relative flex items-center justify-center w-32 h-32 rounded-full heart-live mb-4">
                             <i data-lucide="heart" class="w-16 h-16 text-white fill-white"></i>
                         </div>
                         <div class="mt-2 text-center">
                             <span id="health-bpm" class="text-5xl font-bold">58</span>
                             <p class="text-sm text-gray-400">—É–¥/–º–∏–Ω</p>
                         </div>
                    </div>
                </div>

                <div class="glass-card p-4">
                    <div class="flex justify-between items-center mb-2">
                        <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white">
                            <i data-lucide="footprints" class="w-6 h-6"></i>
                        </div>
                        <div class="text-right">
                             <p class="text-xs text-gray-400">–ú–æ–∏ —à–∞–≥–∏</p>
                             <h3 class="text-2xl font-bold">5,600</h3>
                        </div>
                    </div>
                    <div class="bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-lg flex gap-3 items-start">
                        <i data-lucide="triangle-alert" class="w-5 h-5 text-yellow-500 shrink-0 mt-0.5"></i>
                        <p class="text-xs text-yellow-200 leading-tight">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —É–≤–µ–ª–∏—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–æ 8000 —à–∞–≥–æ–≤ –≤ –¥–µ–Ω—å.</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <div class="glass-card p-4">
                        <div class="flex items-center gap-2 mb-2 text-green-400"><i data-lucide="moon" class="w-4 h-4"></i> <span class="text-xs">–°–æ–Ω</span></div>
                        <h3 class="text-xl font-bold">7.5 —á</h3>
                    </div>
                      <div class="glass-card p-4">
                        <div class="flex items-center gap-2 mb-2 text-yellow-400"><i data-lucide="droplet" class="w-4 h-4"></i> <span class="text-xs">–í–æ–¥–∞</span></div>
                        <h3 class="text-xl font-bold">1.8 –ª</h3>
                    </div>
                      <div class="glass-card p-4">
                        <div class="flex items-center gap-2 mb-2 text-teal-400"><i data-lucide="thermometer" class="w-4 h-4"></i> <span class="text-xs">–¢–µ–º–ø.</span></div>
                        <h3 class="text-xl font-bold">36.6¬∞C</h3>
                    </div>
                      <div class="glass-card p-4">
                        <div class="flex items-center gap-2 mb-2 text-blue-400"><i data-lucide="zap" class="w-4 h-4"></i> <span class="text-xs">–≠–Ω–µ—Ä–≥–∏—è</span></div>
                        <h3 class="text-xl font-bold">78%</h3>
                    </div>
                </div>
            </div>
        </section>

        <section id="screen-workouts" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
            <h2 class="font-bold text-lg mb-6 mt-2">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>

            <div class="mb-8">
                <h3 class="text-sm uppercase text-gray-500 font-bold mb-3 tracking-wider">–ú–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
                <div onclick="showWorkoutDetail('morning')" class="glass-card border-l-4 border-l-teal-400 flex justify-between items-center cursor-pointer">
                    <div>
                        <h4 class="font-bold text-lg">–£—Ç—Ä–µ–Ω–Ω–∏–π –¢–æ–Ω—É—Å</h4>
                        <p class="text-xs text-gray-400">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ ‚Ä¢ 15 –º–∏–Ω ‚Ä¢ –õ–µ–≥–∫–∞—è</p>
                    </div>
                    <button class="px-4 py-2 bg-teal-600/20 text-teal-300 rounded-lg text-sm font-semibold">–ù–∞—á–∞—Ç—å</button>
                </div>
            </div>

            <div>
                <h3 class="text-sm uppercase text-gray-500 font-bold mb-3 tracking-wider">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                <div class="grid grid-cols-1 gap-3">
                    <div onclick="showWorkoutDetail('cardio')" class="glass-card flex items-center gap-4 cursor-pointer hover:bg-white/5 transition">
                        <div class="bg-orange-500/20 p-3 rounded-xl"><i data-lucide="activity" class="text-orange-400"></i></div>
                        <div class="flex-1">
                            <h4 class="font-bold">–ö–∞—Ä–¥–∏–æ –∏ –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å</h4>
                            <p class="text-xs text-gray-400">–ë–µ–≥, —Å–∫–∞–∫–∞–ª–∫–∞, HIIT</p>
                        </div>
                         <i data-lucide="chevron-right" class="text-gray-500 w-5 h-5"></i>
                    </div>
                    <div onclick="showWorkoutDetail('gym')" class="glass-card flex items-center gap-4 cursor-pointer hover:bg-white/5 transition">
                        <div class="bg-blue-500/20 p-3 rounded-xl"><i data-lucide="dumbbell" class="text-blue-400"></i></div>
                         <div class="flex-1">
                            <h4 class="font-bold">–°–∏–ª–æ–≤—ã–µ –≤ –∑–∞–ª–µ</h4>
                            <p class="text-xs text-gray-400">–°–≤–æ–±–æ–¥–Ω—ã–µ –≤–µ—Å–∞, —Ç—Ä–µ–Ω–∞–∂–µ—Ä—ã</p>
                        </div>
                        <i data-lucide="chevron-right" class="text-gray-500 w-5 h-5"></i>
                    </div>
                    <div onclick="showWorkoutDetail('yoga')" class="glass-card flex items-center gap-4 cursor-pointer hover:bg-white/5 transition">
                        <div class="bg-purple-500/20 p-3 rounded-xl"><i data-lucide="flower-2" class="text-purple-400"></i></div>
                         <div class="flex-1">
                            <h4 class="font-bold">–ô–æ–≥–∞ –∏ –†–∞—Å—Ç—è–∂–∫–∞</h4>
                            <p class="text-xs text-gray-400">–ì–∏–±–∫–æ—Å—Ç—å, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</p>
                        </div>
                        <i data-lucide="chevron-right" class="text-gray-500 w-5 h-5"></i>
                    </div>
                </div>
            </div>
        </section>

        <section id="screen-nutrition" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
            <h2 class="font-bold text-lg mb-6 mt-2">–ü–∏—Ç–∞–Ω–∏–µ</h2>
            <div class="glass-card p-8 text-center text-gray-400 flex flex-col items-center justify-center min-h-[300px]">
                <i data-lucide="utensils" class="w-16 h-16 mb-4 opacity-30"></i>
                <h3 class="text-xl font-bold text-gray-300 mb-2">–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3>
                <p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏!</p>
            </div>
        </section>

        <section id="screen-devices" class="hidden min-h-screen p-4 pb-24 animate-fade-in">
             <div class="flex items-center gap-3 mb-6 glass-header p-4 -mx-4 -mt-4">
                <button onclick="navigateTo('screen-settings')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>
            </div>
            
            <div class="space-y-4">
                <p class="text-xs text-gray-400 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.</p>
                
                <div class="glass-card flex items-center justify-between p-4">
                    <div class="flex items-center gap-4">
                        <div class="bg-white/10 p-2 rounded-xl"><i data-lucide="activity" class="w-6 h-6 text-white"></i></div>
                        <div>
                            <h4 class="font-bold text-sm">Apple Health</h4>
                            <p class="text-[10px] text-gray-400">iOS Sync</p>
                        </div>
                    </div>
                    <button onclick="simulateConnection(this)" class="px-4 py-2 bg-blue-600/20 border border-blue-500/50 hover:bg-blue-600/40 text-blue-300 rounded-lg text-xs font-semibold transition-all">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</button>
                </div>

                <div class="glass-card flex items-center justify-between p-4">
                    <div class="flex items-center gap-4">
                        <div class="bg-blue-500/10 p-2 rounded-xl"><i data-lucide="watch" class="w-6 h-6 text-blue-400"></i></div>
                        <div>
                            <h4 class="font-bold text-sm">Garmin</h4>
                            <p class="text-[10px] text-gray-400">Connect IQ</p>
                        </div>
                    </div>
                    <button onclick="simulateConnection(this)" class="px-4 py-2 bg-blue-600/20 border border-blue-500/50 hover:bg-blue-600/40 text-blue-300 rounded-lg text-xs font-semibold transition-all">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</button>
                </div>
            </div>
        </section>


        <section id="screen-category-view" class="hidden min-h-screen pb-24">
             <div class="sticky top-0 z-20 glass-header p-4 flex items-center gap-3">
                <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg w-full truncate" id="category-title">...</h2>
            </div>
            <div class="p-4 space-y-3" id="category-tests-list">
                </div>
        </section>

        <section id="screen-analysis-detail" class="hidden min-h-screen pb-24">
            <div class="sticky top-0 z-20 glass-header p-4 flex items-center gap-3">
                <button onclick="backToCategory()" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg w-full truncate" id="detail-title">–î–µ—Ç–∞–ª–∏</h2>
            </div>
            <div class="p-4">
                <div id="detail-content" class="space-y-6 mb-6"></div>
                
                <div class="glass-card border border-blue-500/30">
                    <h4 class="font-bold text-sm mb-2 text-blue-300 flex items-center gap-2">
                        <i data-lucide="sparkles" class="w-4 h-4"></i> Gemini AI
                    </h4>
                    <p class="text-[10px] text-gray-400 mb-2">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –ø–æ —ç—Ç–æ–º—É –∞–Ω–∞–ª–∏–∑—É. –ö–æ–Ω—Ç–µ–∫—Å—Ç —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω.</p>
                    <div id="analysis-chat-output" class="text-xs text-gray-300 mb-3 max-h-48 overflow-y-auto space-y-2 p-2 bg-black/20 rounded"></div>
                    <div class="flex gap-2">
                        <input type="text" id="analysis-chat-input" class="glass-input py-2 text-xs" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠—Ç–æ –æ–ø–∞—Å–Ω–æ?">
                        <button onclick="sendAnalysisQuestion()" class="p-2 bg-blue-600 rounded-lg"><i data-lucide="send" class="w-4 h-4 text-white"></i></button>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="screen-diary" class="hidden min-h-screen pb-24">
            <div class="sticky top-0 z-20 glass-header p-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                    <h2 class="font-bold text-lg">–ú–æ–π –¥–Ω–µ–≤–Ω–∏–∫</h2>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-[10px] text-gray-400 w-16 text-right leading-tight">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å<br>–≤—Ä–∞—á—É</span>
                    <label class="switch">
                        <input type="checkbox" checked id="diary-toggle" onchange="toggleDiaryPrivacy()">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="p-4 space-y-4" id="diary-container">
                </div>

            <button onclick="addNewDiaryEntry()" class="fixed bottom-24 right-6 w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center shadow-lg hover:scale-105 transition z-30">
                <i data-lucide="plus" class="w-8 h-8 text-white"></i>
            </button>
        </section>

        <section id="screen-upcoming" class="hidden min-h-screen p-4 pb-24">
            <div class="flex items-center gap-3 mb-6 glass-header p-4 -mx-4 -mt-4">
                <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –∞–Ω–∞–ª–∏–∑—ã</h2>
            </div>
            
            <div class="glass-card overflow-hidden transition-all duration-300" id="upcoming-card">
                <div onclick="toggleUpcoming()" class="flex justify-between items-center cursor-pointer">
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                             <span class="text-blue-400 font-bold">03 –§–µ–≤ 2026</span>
                             <span class="text-[10px] bg-yellow-500/20 text-yellow-300 px-2 py-0.5 rounded">–û–∂–∏–¥–∞–Ω–∏–µ</span>
                        </div>
                        <h3 class="text-xl font-bold">–õ–∏–ø–∏–¥–æ–≥—Ä–∞–º–º–∞</h3>
                        <p class="text-sm text-gray-400">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</p>
                    </div>
                    <i data-lucide="chevron-down" id="upcoming-arrow" class="w-5 h-5 transition-transform duration-300"></i>
                </div>

                <div id="upcoming-details" class="hidden mt-4 pt-4 border-t border-white/10 space-y-4">
                    <div>
                        <p class="text-xs text-gray-500 uppercase font-bold mb-1">–ë–æ–ª—å–Ω–∏—Ü–∞ (–ö–ª–∏–Ω–∏–∫–∞)</p>
                        <div class="flex items-center gap-2 p-2 bg-white/5 rounded-lg border border-white/10">
                            <i data-lucide="building-2" class="text-blue-400 w-4 h-4"></i>
                            <span class="text-sm font-semibold">CityLab –ê–ª–º–∞—Ç—ã (–î–æ—Å—Ç—ã–∫ 45)</span>
                            <span class="ml-auto text-xs text-green-400">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center bg-white/5 p-2 rounded-lg">
                        <span class="text-sm text-gray-300">–í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏:</span>
                        <span class="font-mono text-lg font-bold">09:30</span>
                    </div>

                    <button onclick="alert('–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞!')" class="w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl flex items-center justify-center gap-2 text-sm font-semibold transition">
                        <i data-lucide="bell" class="w-4 h-4"></i> –ù–∞–ø–æ–º–Ω–∏—Ç—å –º–Ω–µ –∑–∞ –¥–µ–Ω—å
                    </button>
                </div>
            </div>
        </section>

        <section id="screen-doctor" class="hidden min-h-screen p-4 pb-24">
            <div class="flex items-center gap-3 mb-6 glass-header p-4 -mx-4 -mt-4">
                <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg">–ú–æ–π –ª–µ—á–∞—â–∏–π –≤—Ä–∞—á</h2>
            </div>
            
            <div class="glass-card mb-6 text-center pt-8 pb-8 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-20 bg-gradient-to-b from-blue-500/20 to-transparent"></div>
                <div class="w-24 h-24 rounded-full bg-gray-700 mx-auto flex items-center justify-center border-2 border-blue-400 mb-4 shadow-xl text-3xl">üë®‚Äç‚öïÔ∏è</div>
                <h2 class="text-2xl font-bold">–û—Å–∏–ø–æ–≤ –ï–≤–≥–µ–Ω–∏–π –ú–∞—Ä–∞—Ç–æ–≤–∏—á</h2>
                <p class="text-blue-300 text-sm mt-1">–¢–µ—Ä–∞–ø–µ–≤—Ç –≤—ã—Å—à–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, MD</p>
                <div class="mt-4 flex justify-center gap-2">
                    <span class="bg-white/10 px-3 py-1 rounded-full text-xs">–°—Ç–∞–∂ 22 –≥–æ–¥–∞</span>
                </div>
            </div>

            <div class="space-y-4">
                <div class="glass-card">
                    <h3 class="font-bold mb-2 text-gray-300">–û –≤—Ä–∞—á–µ</h3>
                    <p class="text-sm text-gray-400 leading-relaxed">
                        –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∏–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –º–µ–¥–∏—Ü–∏–Ω–µ. –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –∏ —ç–º–ø–∞—Ç–∏—á–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç.
                    </p>
                </div>
                <button onclick="navigateTo('screen-complaints')" class="btn-primary">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (AI –ß–∞—Ç)</button>
            </div>
        </section>
        
         <section id="screen-laboratories" class="hidden min-h-screen p-4 pb-24">
            <div class="flex items-center gap-3 mb-6 glass-header p-4 -mx-4 -mt-4">
                <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏</h2>
            </div>
            
            <div class="space-y-4">
                <div class="glass-card">
                    <h3 class="font-bold text-lg">CityLab –ê–ª–º–∞—Ç—ã</h3>
                    <p class="text-sm text-gray-400 mb-2">–ø—Ä. –î–æ—Å—Ç—ã–∫, 45</p>
                    <div class="flex gap-2">
                        <button onclick="bookLab()" class="flex-1 py-3 border border-white/20 rounded-xl text-sm font-semibold hover:bg-white/10">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="screen-workout-detail" class="hidden min-h-screen p-4 pb-24">
             <div class="flex items-center gap-3 mb-6 glass-header p-4 -mx-4 -mt-4">
                <button onclick="navigateTo('screen-workouts')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg" id="wo-detail-title">...</h2>
            </div>
            <div id="wo-detail-content" class="space-y-4"></div>
        </section>

        <section id="screen-complaints" class="hidden flex flex-col h-screen bg-[#0f1115] pb-24">
            <div class="p-4 glass-header flex items-center gap-3 z-10">
                <button onclick="navigateTo('screen-doctor')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <div>
                    <h2 class="font-bold">–ß–∞—Ç —Å –≤—Ä–∞—á–æ–º (AI)</h2>
                    <p class="text-xs text-green-400">–û–Ω–ª–∞–π–Ω</p>
                </div>
            </div>
            <div id="main-chat-history" class="flex-1 overflow-y-auto p-4 space-y-4">
                <div class="flex gap-3">
                    <div class="w-8 h-8 rounded-full bg-pink-500 flex items-center justify-center text-xs font-bold">Bot</div>
                    <div class="bg-gray-800 p-3 rounded-2xl rounded-tl-none max-w-[80%] text-sm">
                        –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ —Å–∏–º–ø—Ç–æ–º—ã, —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–º–æ—á—å –∏ –ø–µ—Ä–µ–¥–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—Ä–∞—á—É.
                    </div>
                </div>
            </div>
            <div class="p-4 glass-panel">
                <div class="flex gap-2 relative">
                    <input type="text" id="main-chat-input" class="glass-input pr-10" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
                    <button onclick="sendGemini('main-chat-input', 'main-chat-history', '–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –≤—Ä–∞—á–∞. –û—Ç–≤–µ—á–∞–π —ç–º–ø–∞—Ç–∏—á–Ω–æ, —Å–ø—Ä–∞—à–∏–≤–∞–π —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã.')" class="absolute right-1 top-1 bottom-1 bg-blue-600 w-10 rounded-lg flex items-center justify-center"><i data-lucide="send" class="w-4 h-4 text-white"></i></button>
                </div>
            </div>
        </section>

        <section id="screen-voice-analysis" class="hidden min-h-screen flex flex-col relative overflow-y-auto pb-24">
            <div class="p-4 glass-header flex items-center gap-3 z-10 sticky top-0">
                <button onclick="navigateTo('screen-analyses')" class="p-2 rounded-full bg-white/10"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="font-bold text-lg">–†–∞–∑–±–æ—Ä –∞–Ω–∞–ª–∏–∑–æ–≤</h2>
            </div>
            
            <div class="flex-1 flex flex-col items-start p-6 space-y-8 w-full">
                <div class="glass-card p-6 w-full max-w-sm flex flex-col items-start gap-4 border border-pink-500/20 text-left">
                    <div class="w-20 h-20 bg-pink-500/20 rounded-full flex items-center justify-center animate-pulse">
                        <i data-lucide="mic" class="w-10 h-10 text-pink-400"></i>
                    </div>
                    <div>
                         <h3 class="font-bold text-xl mb-1">–ì–æ–≤–æ—Ä–∏—Ç–µ —Å AI</h3>
                         <p class="text-sm text-gray-400">–ì–æ–ª–æ—Å–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∏–∂–µ. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–∏–∞–ª–æ–≥–∞.</p>
                    </div>
                </div>

                <div class="w-full max-w-sm min-h-[350px] flex flex-col justify-start items-start rounded-2xl border-2 border-dashed border-white/10 bg-black/20 relative p-4">
                      <p class="text-xs text-gray-500 mb-4 uppercase tracking-widest">–ó–æ–Ω–∞ –≤–∏–¥–∂–µ—Ç–∞</p>
                      <div class="w-full flex justify-start">
                        <elevenlabs-convai agent-id="agent_8001kfgg5keje9qtyfrkd4853y1c"></elevenlabs-convai>
                      </div>
                </div>
            </div>
        </section>

    </div>

    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>

    <script>
        // --- INIT ---
        lucide.createIcons();
        const GEMINI_API_KEY = "AIzaSyCAgSeyibayMNQiWHLXm1aA1a_rcIOYSkQ";

        // --- DIARY DATA ---
        let diaryEntries = [
            {
                id: 1,
                date: "20.01.2026, 09:30",
                color: "red",
                text: "–°–∏–ª—å–Ω–∞—è –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å –≤ –≤–∏—Å–∫–∞—Ö. –ü–æ—Å–ª–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—ã–ª–∏ –≤—ã–ø–∏—Å–∞–Ω—ã –ª–µ–∫–∞—Ä—Å—Ç–≤–∞, –ø—Ä–∏–Ω—è–ª, –∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ —á–µ—Ä–µ–∑ 20 –º–∏–Ω—É—Ç.",
                expanded: false
            },
            {
                id: 2,
                date: "15.01.2026, 18:45",
                color: "yellow",
                text: "–ë—ã–ª–æ —É—á–∞—â–µ–Ω–∏–µ –ø—É–ª—å—Å–∞ –¥–æ 120. –•–æ—Ä–æ—à–æ —á—Ç–æ –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–æ—à–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Ç–µ—Å—Ç –≤ Health Lab KZ ‚Äî –≤—ã—è–≤–∏–ª–∏ –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞–≥–Ω–∏—è. –í—Ä–∞—á–∏ —Å–∫–∞–∑–∞–ª–∏, –µ—Å–ª–∏ –±—ã –≤–æ–≤—Ä–µ–º—è –Ω–µ –≤—ã—è–≤–∏–ª–∏, –º–æ–≥–ª–∏ –±—ã—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è. –°–µ–π—á–∞—Å –≤—Å–µ –≤ –Ω–æ—Ä–º–µ.",
                expanded: false
            },
            {
                id: 3,
                date: "10.01.2026, 22:00",
                color: "blue",
                text: "–ß—É–≤—Å—Ç–≤–æ–≤–∞–ª —É—Å—Ç–∞–ª–æ—Å—Ç—å –ø–æ—Å–ª–µ –µ–¥—ã. –°–¥–µ–ª–∞–ª –∑–∞–º–µ—Ä –≥–ª—é–∫–æ–∑—ã ‚Äî –Ω–æ—Ä–º–∞. –í—Ä–∞—á —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É–∂–∏–Ω. –ü–æ–º–æ–≥–ª–æ.",
                expanded: false
            }
        ];

        // --- THEME LOGIC ---
        function applyTheme(themeName) {
            document.body.removeAttribute('data-theme');
            
            // Remove active class from all theme cards
            document.querySelectorAll('.theme-card').forEach(el => el.classList.remove('active-theme'));

            if (themeName === 'white') {
                document.body.setAttribute('data-theme', 'white');
                document.getElementById('theme-white').classList.add('active-theme');
            } else if (themeName === 'onyx') {
                document.body.setAttribute('data-theme', 'onyx');
                document.getElementById('theme-onyx').classList.add('active-theme');
            } else {
                // Default
                document.getElementById('theme-default').classList.add('active-theme');
            }
            lucide.createIcons();
        }

        // --- NAVIGATION ---
        function switchTab(screenId, btnElement) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            btnElement.classList.add('active');
            navigateTo(screenId);
        }

        function navigateTo(screenId) {
            document.querySelectorAll('section[id^="screen-"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(screenId).classList.remove('hidden');
            window.scrollTo(0,0);
            
            if(screenId === 'screen-health') startHeart();
            else stopHeart();

            if(screenId === 'screen-diary') renderDiary();
            if(screenId === 'screen-analyses') renderCategories(); 
        }

        function handleLogin() { 
            document.getElementById('bottom-nav').classList.remove('hidden');
            document.getElementById('default-tab-btn').click();
        }

        function simulateConnection(btn) {
            if(btn.disabled) return;
            btn.disabled = true;
            btn.innerHTML = '<i data-lucide="loader-2" class="animate-spin w-4 h-4 inline mr-1"></i> –ü–æ–∏—Å–∫...';
            lucide.createIcons();

            setTimeout(() => {
                btn.className = "px-4 py-2 bg-green-500 text-white rounded-lg text-xs font-bold transition-all flex items-center gap-1";
                btn.innerHTML = '<i data-lucide="check" class="w-4 h-4 inline"></i> –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                lucide.createIcons();
            }, 2500);
        }

        // --- HEARTBEAT ---
        let heartInt;
        function startHeart() {
            const el = document.getElementById('health-bpm');
            if (heartInt) clearInterval(heartInt);
            heartInt = setInterval(() => {
                const val = Math.floor(Math.random() * (65 - 55 + 1) + 55);
                if(el) el.innerText = val;
            }, 2000);
        }
        function stopHeart() { clearInterval(heartInt); }

        // --- DIARY LOGIC ---
        function renderDiary() {
            const container = document.getElementById('diary-container');
            container.innerHTML = '';
            
            diaryEntries.forEach((entry, index) => {
                const div = document.createElement('div');
                div.className = `glass-card border-l-2 border-l-${entry.color}-400 transition-all`;
                
                let iconColor = document.getElementById('diary-toggle').checked ? 'text-green-400' : 'text-gray-600';

                if (!entry.expanded) {
                    div.innerHTML = `
                        <div onclick="toggleEntry(${index})" class="cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-400 mb-2">
                                <span>${entry.date}</span>
                                <i data-lucide="eye" class="w-3 h-3 ${iconColor} diary-icon-status"></i>
                            </div>
                            <p class="text-sm line-clamp-2">${entry.text}</p>
                        </div>
                    `;
                } else {
                    div.innerHTML = `
                          <div class="flex justify-between text-xs text-gray-400 mb-2">
                            <span class="font-bold text-white">${entry.date}</span>
                            <i onclick="toggleEntry(${index})" data-lucide="chevron-up" class="w-4 h-4 cursor-pointer text-gray-400"></i>
                        </div>
                        <textarea class="diary-textarea" oninput="updateEntry(${index}, this.value)">${entry.text}</textarea>
                        <p class="text-[10px] text-gray-500 mt-2 italic text-right">–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</p>
                    `;
                }
                container.appendChild(div);
            });
            lucide.createIcons();
        }

        function toggleEntry(index) {
            diaryEntries[index].expanded = !diaryEntries[index].expanded;
            renderDiary();
        }

        function updateEntry(index, value) {
            diaryEntries[index].text = value;
        }

        function addNewDiaryEntry() {
            const now = new Date();
            const dateStr = now.toLocaleDateString() + ", " + now.toLocaleTimeString().slice(0,5);
            
            diaryEntries.unshift({
                id: Date.now(),
                date: dateStr,
                color: "green",
                text: "–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å...",
                expanded: true
            });
            renderDiary();
        }

        function toggleDiaryPrivacy() {
            renderDiary(); 
        }

        // --- UPCOMING LOGIC ---
        function toggleUpcoming() {
            const details = document.getElementById('upcoming-details');
            const arrow = document.getElementById('upcoming-arrow');
            
            if (details.classList.contains('hidden')) {
                details.classList.remove('hidden');
                details.classList.add('animate-fade-in');
                arrow.style.transform = 'rotate(180deg)';
            } else {
                details.classList.add('hidden');
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        // --- GEMINI CORE FUNCTION ---
        async function sendGemini(inputId, outputId, systemContext) {
            const input = document.getElementById(inputId);
            const output = document.getElementById(outputId);
            const text = input.value;
            if(!text) return;

            // UI User Msg
            const userDiv = document.createElement('div');
            userDiv.className = "bg-blue-600/30 p-2 rounded-lg rounded-tr-none self-end text-right ml-auto max-w-[85%] mb-2 text-sm";
            userDiv.innerText = text;
            output.appendChild(userDiv);
            input.value = '';
            output.scrollTop = output.scrollHeight;

            // UI Loading
            const loadDiv = document.createElement('div');
            loadDiv.className = "text-gray-500 text-xs italic animate-pulse mb-2";
            loadDiv.innerText = "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...";
            output.appendChild(loadDiv);

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: `System: ${systemContext}. User Question: ${text}` }]
                        }]
                    })
                });
                
                const data = await response.json();
                output.removeChild(loadDiv);
                
                let reply = "–ò–∑–≤–∏–Ω–∏—Ç–µ, —Å–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.";
                if(data.candidates && data.candidates[0] && data.candidates[0].content) {
                    reply = data.candidates[0].content.parts[0].text;
                } else if (data.error) {
                    reply = "–û—à–∏–±–∫–∞ API: " + data.error.message;
                }
                
                const botDiv = document.createElement('div');
                botDiv.className = "bg-gray-700/50 p-3 rounded-lg rounded-tl-none self-start max-w-[90%] mb-2 text-sm";
                reply = reply.replace(/\*\*(.*?)\*\*/g, '<strong class="text-blue-300">$1</strong>');
                botDiv.innerHTML = `<strong class="text-purple-300 block text-xs mb-1">Health AI</strong>${reply}`;
                output.appendChild(botDiv);
                output.scrollTop = output.scrollHeight;

            } catch(e) {
                console.error(e);
                output.removeChild(loadDiv);
                const errDiv = document.createElement('div');
                errDiv.className = "text-red-400 text-xs mb-2";
                errDiv.innerText = "–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è";
                output.appendChild(errDiv);
            }
        }

        // --- CATEGORY DATA LOGIC ---
        // Added 'color' field for Premium Icon Look
        const categoryList = [
            { id: 'heart', name: '–°–µ—Ä–¥—Ü–µ', icon: 'heart', color: 'red', stats: { green: 3, red: 1, gray: 2 } },
            { id: 'stress', name: '–°—Ç—Ä–µ—Å—Å –∏ —Å—Ç–∞—Ä–µ–Ω–∏–µ', icon: 'brain-circuit', color: 'purple', stats: { green: 0, red: 2, gray: 0 } },
            { id: 'gender', name: '–ú—É–∂/–ñ–µ–Ω –∑–¥–æ—Ä–æ–≤—å–µ', icon: 'users', color: 'blue', stats: { green: 1, red: 2, gray: 7 } },
            { id: 'immunity', name: '–ò–º–º—É–Ω–∏—Ç–µ—Ç', icon: 'shield', color: 'orange', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'meta', name: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', icon: 'zap', color: 'yellow', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'toxins', name: '–¢–æ–∫—Å–∏–Ω—ã –æ–∫—Ä. —Å—Ä–µ–¥—ã', icon: 'biohazard', color: 'green', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'age', name: '–ë–∏–æ–ª–æ–≥–∏—á. –≤–æ–∑—Ä–∞—Å—Ç', icon: 'hourglass', color: 'teal', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'vitamins', name: '–í–∏—Ç–∞–º–∏–Ω—ã', icon: 'pill', color: 'pink', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'liver', name: '–ü–µ—á–µ–Ω—å', icon: 'activity', color: 'indigo', stats: { green: 0, red: 0, gray: 0 } }, 
            { id: 'blood', name: '–ö—Ä–æ–≤—å', icon: 'droplet', color: 'red', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'kidney', name: '–ü–æ—á–∫–∏', icon: 'activity', color: 'orange', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'pancreas', name: '–ü–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–∞—è', icon: 'activity', color: 'yellow', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'brain', name: '–ú–æ–∑–≥', icon: 'brain', color: 'pink', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'elctro', name: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç—ã', icon: 'zap', color: 'blue', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'allergy', name: '–ê–ª–ª–µ—Ä–≥–∏—è', icon: 'flower', color: 'green', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'sex', name: '–°–µ–∫—Å—É–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ', icon: 'heart-handshake', color: 'purple', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'bones', name: '–ó–¥–æ—Ä–æ–≤—å–µ –∫–æ—Å—Ç–µ–π', icon: 'bone', color: 'stone', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'infect', name: '–ò–Ω—Ñ–µ–∫—Ü–∏–∏', icon: 'bug', color: 'lime', stats: { green: 0, red: 0, gray: 0 } },
            { id: 'mri', name: '–ú–†–¢ –∏ –ö–¢', icon: 'scan-line', color: 'sky', stats: { green: 0, red: 0, gray: 0 } }
        ];

        const categoryTestsData = {
            'heart': [
                { id: 'apo_b', name: "–ê–ø–æ–ª–∏–ø–æ–ø—Ä–æ—Ç–µ–∏–Ω –í", val: "84 –º–º–æ–ª—å/–ª", ref: "< 1.0", status: "norm" }, 
                { id: 'hdl', name: "–•–æ–ª–µ—Å—Ç–µ—Ä–æ–ª-–õ–ü–í–ü", val: "50 –º–º–æ–ª—å/–ª", ref: "> 1.0", status: "warn" },
                { id: 'crp', name: "–í—ã—Å–æ–∫–æ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –°-—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –±–µ–ª–æ–∫ (–∫–∞—Ä–¥–∏–æ)", val: "89 –º–º–æ–ª—å/–ª", ref: "< 1.0", status: "norm", desc: "–ú–∞—Ä–∫–µ—Ä –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è —Å–æ—Å—É–¥–æ–≤" },
                { id: 'ldl', name: "–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω –ª–∏–ø–æ–ø—Ä–æ—Ç–µ–∏–¥–æ–≤ –Ω–∏–∑–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, –ø—Ä—è–º–æ–π –º–µ—Ç–æ–¥", val: "111 –º–º–æ–ª—å/–ª", ref: "< 3.0", status: "norm" },
                { id: 'lpa', name: "–õ–∏–ø–æ–ø—Ä–æ—Ç–µ–∏–Ω (a)", val: "...", ref: "< 0.3", status: "norm" },
                { id: 'chol_tot', name: "–•–æ–ª–µ—Å—Ç–µ—Ä–æ–ª –æ–±—â–∏–π", val: "...", ref: "< 5.2", status: "norm" }
            ],
            'stress': [
                 { id: 'cortisol', name: "–ö–æ—Ä—Ç–∏–∑–æ–ª", val: "230 –º–º–æ–ª—å/–ª", ref: "100-200", status: "warn" },
                 { id: 'dhea', name: "–î–≠–ê-S04 (DHEA-S)", val: "30 –º–º–æ–ª—å/–ª", ref: "> 50", status: "warn" }
            ],
            'gender': [
                { id: 'free_testo', name: "–¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω —Å–≤–æ–±–æ–¥–Ω—ã–π", val: "85 –º–º–æ–ª—å/–ª", ref: "> 50", status: "norm" },
                { id: 'total_testo', name: "–¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω (Testosterone)", val: "10 –º–º–æ–ª—å/–ª", ref: "> 12", status: "warn" },
                { id: 'shbg', name: "–ì–°–ü–ì (SHBG)", val: "10 –º–º–æ–ª—å/–ª", ref: "> 13", status: "warn" },
                { id: 'psa_total', name: "PSA –æ–±—â–∏–π (Prostate Specific Antigen)", val: "...", ref: "", status: "pending" },
                { id: 'psa_free', name: "–ü–°–ê —Å–≤–æ–±–æ–¥–Ω—ã–π (f-PSA)", val: "...", ref: "", status: "pending" },
                { id: 'prolactin', name: "–ü—Ä–æ–ª–∞–∫—Ç–∏–Ω (Prolactin, PRL)", val: "...", ref: "", status: "pending" },
                { id: 'lh', name: "–õ—é—Ç–µ–∏–Ω–∏–∑–∏—Ä—É—é—â–∏–π –≥–æ—Ä–º–æ–Ω (–õ–ì, LH)", val: "...", ref: "", status: "pending" },
                { id: 'fsh', name: "–§–æ–ª–ª–∏–∫—É–ª–æ—Å—Ç–∏–º—É–ª–∏—Ä—É—é—â–∏–π –≥–æ—Ä–º–æ–Ω (–§–°–ì)", val: "...", ref: "", status: "pending" },
                { id: 'estradiol', name: "–≠—Å—Ç—Ä–∞–¥–∏–æ–ª (E2, Estradiol)", val: "...", ref: "", status: "pending" },
                { id: 'dhea_s_gender', name: "–î–≠–ê-S04 (DHEA-S)", val: "...", ref: "", status: "pending" }
            ]
        };

        let activeCategoryId = null;

        function renderCategories() {
            const grid = document.getElementById('categories-grid');
            grid.innerHTML = '';
            
            categoryList.forEach(cat => {
                const el = document.createElement('div');
                el.className = 'glass-card p-4 flex flex-col justify-between min-h-[100px] cursor-pointer hover:bg-white/5 active:scale-95 transition relative overflow-hidden group';
                el.onclick = () => openCategory(cat.id, cat.name);
                
                // --- PREMIUM ICON BACKGROUND GENERATION ---
                // Mapping generic color names to Tailwind classes
                let bgClass = "bg-gray-500/20 text-gray-400";
                if(cat.color === 'red') bgClass = "bg-red-500/20 text-red-400";
                else if(cat.color === 'purple') bgClass = "bg-purple-500/20 text-purple-400";
                else if(cat.color === 'blue') bgClass = "bg-blue-500/20 text-blue-400";
                else if(cat.color === 'orange') bgClass = "bg-orange-500/20 text-orange-400";
                else if(cat.color === 'green') bgClass = "bg-green-500/20 text-green-400";
                else if(cat.color === 'yellow') bgClass = "bg-yellow-500/20 text-yellow-400";
                else if(cat.color === 'pink') bgClass = "bg-pink-500/20 text-pink-400";
                else if(cat.color === 'teal') bgClass = "bg-teal-500/20 text-teal-400";
                else if(cat.color === 'indigo') bgClass = "bg-indigo-500/20 text-indigo-400";
                else if(cat.color === 'sky') bgClass = "bg-sky-500/20 text-sky-400";
                else if(cat.color === 'lime') bgClass = "bg-lime-500/20 text-lime-400";

                let badgesHtml = '<div class="flex flex-wrap gap-2 mt-3">';
                if (cat.stats.green > 0) {
                    badgesHtml += `
                        <div class="flex items-center gap-1.5 bg-emerald-500/20 px-2 py-1 rounded text-[10px] text-emerald-300 font-bold border border-emerald-500/10">
                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div> ${cat.stats.green}
                        </div>
                    `;
                }
                if (cat.stats.red > 0) {
                      badgesHtml += `
                        <div class="flex items-center gap-1.5 bg-red-500/20 px-2 py-1 rounded text-[10px] text-red-300 font-bold border border-red-500/10">
                            <div class="w-1.5 h-1.5 rounded-full bg-red-400"></div> ${cat.stats.red}
                        </div>
                    `;
                }
                if (cat.stats.gray > 0) {
                      badgesHtml += `
                        <div class="flex items-center gap-1.5 bg-gray-500/20 px-2 py-1 rounded text-[10px] text-gray-300 font-bold border border-gray-500/10">
                            <div class="w-1.5 h-1.5 rounded-full bg-gray-400"></div> ${cat.stats.gray}
                        </div>
                    `;
                }
                badgesHtml += '</div>';

                el.innerHTML = `
                    <div class="flex items-center gap-2 mb-1">
                        <div class="icon-box w-8 h-8 rounded-lg ${bgClass}">
                            <i data-lucide="${cat.icon}" class="w-4 h-4"></i>
                        </div>
                        <h3 class="font-bold text-sm leading-tight">${cat.name}</h3>
                    </div>
                    ${badgesHtml}
                `;
                grid.appendChild(el);
            });
            lucide.createIcons();
        }

        function openCategory(id, name) {
            activeCategoryId = id;
            document.getElementById('screen-analyses').classList.add('hidden');
            document.getElementById('screen-category-view').classList.remove('hidden');
            document.getElementById('category-title').innerText = name;
            window.scrollTo(0,0);
            
            const listContainer = document.getElementById('category-tests-list');
            listContainer.innerHTML = '';

            const tests = categoryTestsData[id];
            
            if (!tests) {
                listContainer.innerHTML = '<div class="text-center text-gray-400 mt-10">–ê–Ω–∞–ª–∏–∑ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ<br></div>';
                return;
            }

            tests.forEach(t => {
                const item = document.createElement('div');
                item.className = 'glass-card p-4 flex justify-between items-center cursor-pointer hover:bg-white/5';
                item.onclick = () => showTestDetail(t);
                
                const isInProgress = (t.status === 'pending' || t.id === 'lpa' || t.id === 'chol_tot');
                const valDisplay = isInProgress ? '<i data-lucide="hourglass" class="w-3 h-3 text-yellow-400 animate-spin-slow"></i>' : t.val;
                const isWarn = t.status === 'warn';
                
                item.innerHTML = `
                    <div class="flex-1 pr-2">
                        <h4 class="font-bold text-sm ${isWarn ? 'text-red-300' : 'text-gray-200'} mb-1 flex items-center gap-2">
                            ${t.name}
                            ${isWarn ? '<i data-lucide="alert-circle" class="w-3 h-3 text-red-400"></i>' : ''}
                        </h4>
                        <div class="flex items-center gap-2 text-xs">
                             <span class="text-gray-400">${valDisplay}</span>
                             ${isWarn ? '<span class="text-red-400 bg-red-400/10 px-1 rounded">–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</span>' : ''}
                        </div>
                    </div>
                    <div class="h-8 w-1 rounded-full ${isInProgress ? 'bg-yellow-500/50' : (isWarn ? 'bg-red-500' : 'bg-green-500')}"></div>
                `;
                listContainer.appendChild(item);
            });
            lucide.createIcons();
        }

        let currentAnalysisContext = "";

        function showTestDetail(testData) {
            document.getElementById('screen-category-view').classList.add('hidden');
            document.getElementById('screen-analysis-detail').classList.remove('hidden');
            window.scrollTo(0,0);
            
            document.getElementById('detail-title').innerText = testData.name;
            const content = document.getElementById('detail-content');
            
            currentAnalysisContext = `–¢—ã –≤—Ä–∞—á. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ—Ç—Ä–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ "${testData.name}". –ó–Ω–∞—á–µ–Ω–∏–µ: ${testData.val}. –†–µ—Ñ–µ—Ä–µ–Ω—Å: ${testData.ref}. –°—Ç–∞—Ç—É—Å: ${testData.status === 'norm' ? '–ù–æ—Ä–º–∞' : '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ'}. –û–±—ä—è—Å–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ä–∏—Å–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫—Ä–∞—Ç–∫–æ.`;
            document.getElementById('analysis-chat-output').innerHTML = '';

            // --- REUSABLE GRAPH COMPONENT ---
            const getGraphHTML = (title, valueStr, desc, diseases, prevVal, currVal, boundaries = null, dates = null) => `
                <div class="glass-card p-6 relative overflow-hidden">
                    <div class="flex flex-col gap-6">
                        <div class="z-10 relative">
                            <h2 class="text-3xl font-serif-display text-white mb-2">${title}</h2>
                            <div class="text-xl font-bold text-white mb-4">–í –Ω–æ—Ä–º–µ ${valueStr}</div>
                            <p class="text-xs text-gray-300 leading-relaxed mb-4">${desc}</p>
                            <div class="mt-4 p-3 bg-red-500/10 rounded-lg border border-red-500/20">
                                <p class="text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold">–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</p>
                                <ul class="text-xs text-gray-300 space-y-1">
                                    ${diseases.map(d => `<li>‚Ä¢ ${d}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                        <div class="w-full h-48 relative border-l border-white/10 pl-4 mt-2">
                            <div class="absolute inset-0 flex flex-col justify-between text-[9px] text-gray-500 font-bold tracking-wider py-4">
                                     <div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í–´–®–ï –ù–û–†–ú–´</div>
                                     <div class="flex items-center gap-2"><div class="h-6 w-1 bg-green-500 rounded-full shadow-[0_0_10px_#22c55e]"></div> –í –ù–û–†–ú–ï</div>
                                     <div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –ù–ò–ñ–ï –ù–û–†–ú–´</div>
                            </div>
                            <div class="absolute top-1/3 left-0 w-full border-t border-dashed border-white/10"></div>
                            <div class="absolute top-2/3 left-0 w-full border-t border-dashed border-white/10"></div>
                            
                            ${boundaries ? `
                                <div class="absolute top-[31%] right-0 text-[10px] text-gray-400 font-mono">${boundaries[0]}*</div>
                                <div class="absolute top-[64%] right-0 text-[10px] text-gray-400 font-mono">${boundaries[1]}*</div>
                            ` : ''}

                            <div class="absolute top-[${title.includes('–õ–ü–í–ü') ? '10%' : '20%'}] right-[35%] flex flex-col items-center z-10">
                                     <span class="text-xs font-bold text-gray-300 mb-1">${prevVal}</span>
                                     <div class="w-3 h-3 rounded-full border-2 border-orange-400 bg-[#1e1b4b]"></div>
                                     ${dates ? `<span class="text-[9px] text-white/40 mt-1 font-mono">${dates[0]}</span>` : ''}
                            </div>
                            
                            <div class="absolute top-[50%] right-[10%] flex flex-col items-center z-10">
                                     <span class="text-xs font-bold text-green-400 mb-1">${currVal}</span>
                                     <div class="w-3 h-3 rounded-full bg-green-500 shadow-[0_0_10px_#22c55e]"></div>
                                     ${dates ? `<span class="text-[9px] text-white/40 mt-1 font-mono">${dates[1]}</span>` : ''}
                            </div>
                            
                            <svg class="absolute inset-0 w-full h-full pointer-events-none">
                                <line x1="65%" y1="${title.includes('–õ–ü–í–ü') ? '15%' : '25%'}" x2="90%" y2="55%" stroke="rgba(255,255,255,0.3)" stroke-width="1" />
                            </svg>
                       </div>
                       <div class="text-[9px] text-gray-500 mt-2 pt-2 border-t border-white/5">
                           * –≥—Ä–∞–Ω–∏—Ü—ã –Ω–æ—Ä–º–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –†–ö
                       </div>
                   </div>
                </div>
            `;

            if (testData.id === 'apo_b') {
                content.innerHTML = getGraphHTML('(ApoB)', '84 –º–º–æ–ª—å/–ª', '–ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–æ–≤—ã—Ö —á–∞—Å—Ç–∏—Ü...', ['–°–µ—Ä–¥–µ—á–Ω–æ —Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è', '–ê—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑'], '93', '84') + `<div class="flex flex-col items-center -mt-6 relative z-0"><div class="h-8 w-px bg-white/20"></div></div><div class="glass-card flex items-center gap-4 p-4 border border-orange-400/30"><div class="p-3 bg-orange-500/20 rounded-xl text-orange-400"><i data-lucide="fish" class="w-6 h-6"></i></div><div><h4 class="font-bold text-sm">–û–º–µ–≥–∞-3 –∂–∏—Ä–Ω—ã–µ –∫–∏—Å–ª–æ—Ç—ã</h4><p class="text-xs text-gray-400">–õ–æ—Å–æ—Å—å 2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</p></div></div>`;
            } else if (testData.id === 'hdl') {
                content.innerHTML = getGraphHTML('–•–æ–ª–µ—Å—Ç–µ—Ä–æ–ª-–õ–ü–í–ü', '50 –º–º–æ–ª—å/–ª','–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ–ª–µ–∑–Ω–æ–≥–æ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞...', ['–°–µ—Ä–¥–µ—á–Ω–æ —Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è', '–ê—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑'], '52', '50', ['60', '45'], ['06.06.2025', '06.12.2025']);
            } else if (testData.id === 'crp') {
                content.innerHTML = getGraphHTML('–í—ã—Å–æ–∫–æ—á—É–≤—Å—Ç–≤. CRP', '89 –º–º–æ–ª—å/–ª', '–ú–æ–∂–µ—Ç –≤—ã—è–≤–ª—è—Ç—å –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è...', ['–•—Ä–æ–Ω–∏—á–µ—Å–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ', '–°–µ—Ä–¥–µ—á–Ω–æ —Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è'], '88', '89');
            } else if (testData.id === 'ldl') {
                content.innerHTML = getGraphHTML('–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω –õ–ü–ù–ü', '111 –º–º–æ–ª—å/–ª', '–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–µ—Ä–µ–Ω–æ—Å —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –∏–∑ –ø–µ—á–µ–Ω–∏...', ['–°–µ—Ä–¥–µ—á–Ω–æ —Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è', '–ê—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑'], '120', '111');
            } else if (testData.id === 'cortisol') {
                 content.innerHTML = `<div class="glass-card p-6 relative overflow-hidden"><div class="flex flex-col gap-6"><div class="z-10 relative"><h2 class="text-3xl font-serif-display text-white mb-2">–ö–æ—Ä—Ç–∏–∑–æ–ª</h2><div class="text-xl font-bold text-red-400 mb-4">–í—ã—à–µ –Ω–æ—Ä–º—ã 230 –º–º–æ–ª—å/–ª</div><p class="text-xs text-gray-300 leading-relaxed mb-4">–ß–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–≥–æ—Ä–º–æ–Ω–æ–º —Å—Ç—Ä–µ—Å—Å–∞¬ª...</p><div class="mt-4 p-3 bg-red-500/10 rounded-lg border border-red-500/20"><p class="text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold">–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</p><ul class="text-xs text-gray-300 space-y-1"><li>‚Ä¢ –ù–∞–¥–ø–æ—á–µ—á–Ω–∏–∫–æ–≤–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å</li><li>‚Ä¢ –°–∏–Ω–¥—Ä–æ–º –ö—É—à–∏–Ω–≥–∞</li></ul></div></div><div class="w-full h-48 relative border-l border-white/10 pl-4 mt-2"><div class="absolute inset-0 flex flex-col justify-between text-[9px] text-gray-500 font-bold tracking-wider py-4"><div class="flex items-center gap-2"><div class="h-6 w-1 bg-red-500 rounded-full shadow-[0_0_10px_#ef4444]"></div> –í–´–®–ï –ù–û–†–ú–´</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í –ù–û–†–ú–ï</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –ù–ò–ñ–ï –ù–û–†–ú–´</div></div><div class="absolute top-1/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-2/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-[31%] right-0 text-[10px] text-gray-400 font-mono">200*</div><div class="absolute top-[64%] right-0 text-[10px] text-gray-400 font-mono">100*</div><div class="absolute top-[50%] right-[35%] flex flex-col items-center z-10"><span class="text-xs font-bold text-gray-300 mb-1">180</span><div class="w-3 h-3 rounded-full border-2 border-gray-400 bg-[#1e1b4b]"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.12.2025</span></div><div class="absolute top-[15%] right-[10%] flex flex-col items-center z-10"><span class="text-xs font-bold text-red-400 mb-1">230</span><div class="w-3 h-3 rounded-full bg-red-500 shadow-[0_0_10px_#ef4444] animate-pulse"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.01.2026</span></div><svg class="absolute inset-0 w-full h-full pointer-events-none"><line x1="65%" y1="50%" x2="90%" y2="15%" stroke="rgba(239,68,68,0.5)" stroke-width="2" stroke-dasharray="4" /></svg></div></div></div>`;
            } else if (testData.id === 'dhea') {
                 content.innerHTML = `<div class="glass-card p-6 relative overflow-hidden"><div class="flex flex-col gap-6"><div class="z-10 relative"><h2 class="text-3xl font-serif-display text-white mb-2">–î–≠–ê-S04</h2><div class="text-xl font-bold text-red-400 mb-4">–ù–∏–∂–µ –Ω–æ—Ä–º—ã 30 –º–º–æ–ª—å/–ª</div><p class="text-xs text-gray-300 leading-relaxed mb-4">–£ –∂–µ–Ω—â–∏–Ω –î–ì–≠–ê-–° —Å–ª—É–∂–∏—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º...</p><div class="mt-4 p-3 bg-red-500/10 rounded-lg border border-red-500/20"><p class="text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold">–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</p><ul class="text-xs text-gray-300 space-y-1"><li>‚Ä¢ –£—Å—Ç–∞–ª–æ—Å—Ç—å</li><li>‚Ä¢ –ì–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å</li></ul></div></div><div class="w-full h-48 relative border-l border-white/10 pl-4 mt-2"><div class="absolute inset-0 flex flex-col justify-between text-[9px] text-gray-500 font-bold tracking-wider py-4"><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í–´–®–ï –ù–û–†–ú–´</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í –ù–û–†–ú–ï</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-red-500 rounded-full shadow-[0_0_10px_#ef4444]"></div> –ù–ò–ñ–ï –ù–û–†–ú–´</div></div><div class="absolute top-1/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-2/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-[31%] right-0 text-[10px] text-gray-400 font-mono">100*</div><div class="absolute top-[64%] right-0 text-[10px] text-gray-400 font-mono">50*</div><div class="absolute top-[50%] right-[35%] flex flex-col items-center z-10"><span class="text-xs font-bold text-gray-300 mb-1">60</span><div class="w-3 h-3 rounded-full border-2 border-gray-400 bg-[#1e1b4b]"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.12.2025</span></div><div class="absolute top-[85%] right-[10%] flex flex-col items-center z-10"><span class="text-xs font-bold text-red-400 mb-1">30</span><div class="w-3 h-3 rounded-full bg-red-500 shadow-[0_0_10px_#ef4444] animate-pulse"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.01.2026</span></div><svg class="absolute inset-0 w-full h-full pointer-events-none"><line x1="65%" y1="50%" x2="90%" y2="85%" stroke="rgba(239,68,68,0.5)" stroke-width="2" stroke-dasharray="4" /></svg></div></div></div>`;
            } else if (testData.id === 'free_testo') {
                content.innerHTML = getGraphHTML('–¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω —Å–≤–æ–±–æ–¥–Ω—ã–π', '85 –º–º–æ–ª—å/–ª', '–≠—Ç–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ —Ç–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω–∞...', ['–ì–∏–ø–æ–≥–æ–Ω–∞–¥–∏–∑–º', '–ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∞—è –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏—è'], '80', '85', ['100', '50']);
            } else if (testData.id === 'total_testo') {
                 content.innerHTML = `<div class="glass-card p-6 relative overflow-hidden"><div class="flex flex-col gap-6"><div class="z-10 relative"><h2 class="text-3xl font-serif-display text-white mb-2">–¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω</h2><div class="text-xl font-bold text-red-400 mb-4">–ù–∏–∂–µ –Ω–æ—Ä–º—ã 10 –º–º–æ–ª—å/–ª</div><p class="text-xs text-gray-300 leading-relaxed mb-4">–ò–∑–º–µ—Ä—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ–≥–æ —Ü–∏—Ä–∫—É–ª–∏—Ä—É—é—â–µ–≥–æ –≤ –∫—Ä–æ–≤–∏ —Ç–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω–∞...</p><div class="mt-4 p-3 bg-red-500/10 rounded-lg border border-red-500/20"><p class="text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold">–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</p><ul class="text-xs text-gray-300 space-y-1"><li>‚Ä¢ –ì–∏–ø–æ–≥–æ–Ω–∞–¥–∏–∑–º</li><li>‚Ä¢ –û–∂–∏—Ä–µ–Ω–∏–µ</li></ul></div></div><div class="w-full h-48 relative border-l border-white/10 pl-4 mt-2"><div class="absolute inset-0 flex flex-col justify-between text-[9px] text-gray-500 font-bold tracking-wider py-4"><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í–´–®–ï –ù–û–†–ú–´</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í –ù–û–†–ú–ï</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-red-500 rounded-full shadow-[0_0_10px_#ef4444]"></div> –ù–ò–ñ–ï –ù–û–†–ú–´</div></div><div class="absolute top-1/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-2/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-[31%] right-0 text-[10px] text-gray-400 font-mono">35*</div><div class="absolute top-[64%] right-0 text-[10px] text-gray-400 font-mono">12*</div><div class="absolute top-[50%] right-[35%] flex flex-col items-center z-10"><span class="text-xs font-bold text-gray-300 mb-1">15</span><div class="w-3 h-3 rounded-full border-2 border-gray-400 bg-[#1e1b4b]"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.12.2025</span></div><div class="absolute top-[80%] right-[10%] flex flex-col items-center z-10"><span class="text-xs font-bold text-red-400 mb-1">10</span><div class="w-3 h-3 rounded-full bg-red-500 shadow-[0_0_10px_#ef4444] animate-pulse"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.01.2026</span></div><svg class="absolute inset-0 w-full h-full pointer-events-none"><line x1="65%" y1="50%" x2="90%" y2="80%" stroke="rgba(239,68,68,0.5)" stroke-width="2" stroke-dasharray="4" /></svg></div></div></div>`;
            } else if (testData.id === 'shbg') {
                 content.innerHTML = `<div class="glass-card p-6 relative overflow-hidden"><div class="flex flex-col gap-6"><div class="z-10 relative"><h2 class="text-3xl font-serif-display text-white mb-2">–ì–°–ü–ì (SHBG)</h2><div class="text-xl font-bold text-red-400 mb-4">–ù–∏–∂–µ –Ω–æ—Ä–º—ã 10 –º–º–æ–ª—å/–ª</div><p class="text-xs text-gray-300 leading-relaxed mb-4">—ç—Ç–æ –±–µ–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å —Ç–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω–æ–º...</p><div class="mt-4 p-3 bg-red-500/10 rounded-lg border border-red-500/20"><p class="text-[10px] uppercase tracking-widest text-gray-400 mb-2 font-bold">–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</p><ul class="text-xs text-gray-300 space-y-1"><li>‚Ä¢ –ì–∏–ø–æ–≥–æ–Ω–∞–¥–∏–∑–º</li><li>‚Ä¢ –ò–Ω—Å—É–ª–∏–Ω–æ—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å</li></ul></div></div><div class="w-full h-48 relative border-l border-white/10 pl-4 mt-2"><div class="absolute inset-0 flex flex-col justify-between text-[9px] text-gray-500 font-bold tracking-wider py-4"><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í–´–®–ï –ù–û–†–ú–´</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-gray-600 rounded-full"></div> –í –ù–û–†–ú–ï</div><div class="flex items-center gap-2"><div class="h-6 w-1 bg-red-500 rounded-full shadow-[0_0_10px_#ef4444]"></div> –ù–ò–ñ–ï –ù–û–†–ú–´</div></div><div class="absolute top-1/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-2/3 left-0 w-full border-t border-dashed border-white/10"></div><div class="absolute top-[31%] right-0 text-[10px] text-gray-400 font-mono">71*</div><div class="absolute top-[64%] right-0 text-[10px] text-gray-400 font-mono">13*</div><div class="absolute top-[50%] right-[35%] flex flex-col items-center z-10"><span class="text-xs font-bold text-gray-300 mb-1">18</span><div class="w-3 h-3 rounded-full border-2 border-gray-400 bg-[#1e1b4b]"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.12.2025</span></div><div class="absolute top-[80%] right-[10%] flex flex-col items-center z-10"><span class="text-xs font-bold text-red-400 mb-1">10</span><div class="w-3 h-3 rounded-full bg-red-500 shadow-[0_0_10px_#ef4444] animate-pulse"></div><span class="text-[9px] text-white/40 mt-1 font-mono">20.01.2026</span></div><svg class="absolute inset-0 w-full h-full pointer-events-none"><line x1="65%" y1="50%" x2="90%" y2="80%" stroke="rgba(239,68,68,0.5)" stroke-width="2" stroke-dasharray="4" /></svg></div></div></div>`;
            } else if (testData.status === 'pending' || testData.id === 'lpa' || testData.id === 'chol_tot') {
                content.innerHTML = `
                    <div class="glass-card p-8 flex flex-col items-center justify-center text-center min-h-[300px] border border-blue-500/30 relative overflow-hidden">
                        <div class="absolute inset-0 bg-blue-500/5 animate-pulse-glow"></div>
                        <div class="w-24 h-24 rounded-full bg-blue-500/10 flex items-center justify-center mb-6 animate-spin-slow border border-blue-400/30">
                            <i data-lucide="loader-2" class="w-10 h-10 text-blue-400"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white mb-2">–ê–Ω–∞–ª–∏–∑ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ</h2>
                        <p class="text-sm text-gray-400 max-w-[200px]">–í–∞—à–∏ –æ–±—Ä–∞–∑—Ü—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏. –ú—ã —É–≤–µ–¥–æ–º–∏–º –≤–∞—Å, –∫–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –≥–æ—Ç–æ–≤—ã.</p>
                        <div class="mt-6 px-4 py-2 bg-white/5 rounded-full text-xs font-mono text-blue-300">
                            –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è: 24—á
                        </div>
                    </div>
                `;
            }
            lucide.createIcons();
        }

        function backToCategory() {
            document.getElementById('screen-analysis-detail').classList.add('hidden');
            document.getElementById('screen-category-view').classList.remove('hidden');
        }

        function sendAnalysisQuestion() {
            if(!currentAnalysisContext) return;
            sendGemini('analysis-chat-input', 'analysis-chat-output', currentAnalysisContext);
        }

        // --- WORKOUTS LOGIC ---
        function showWorkoutDetail(type) {
            navigateTo('screen-workout-detail');
            const title = document.getElementById('wo-detail-title');
            const content = document.getElementById('wo-detail-content');
            
            if (type === 'cardio') {
                title.innerText = "–ö–∞—Ä–¥–∏–æ –ü—Ä–æ–≥—Ä–∞–º–º–∞";
                content.innerHTML = `
                    <div class="glass-card mb-4"><p>–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Å–∂–∏–≥–∞–Ω–∏–µ –∂–∏—Ä–∞.</p></div>
                    <div class="glass-card border-l-4 border-l-orange-400">
                        <h4 class="font-bold">1. –†–∞–∑–º–∏–Ω–∫–∞ (5 –º–∏–Ω)</h4>
                        <p class="text-xs text-gray-400">–õ–µ–≥–∫–∏–π –±–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ, –≤—Ä–∞—â–µ–Ω–∏–µ —Å—É—Å—Ç–∞–≤–æ–≤.</p>
                    </div>
                    <div class="glass-card border-l-4 border-l-orange-400">
                        <h4 class="font-bold">2. –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –±–µ–≥ (20 –º–∏–Ω)</h4>
                        <p class="text-xs text-gray-400">1 –º–∏–Ω —É—Å–∫–æ—Ä–µ–Ω–∏–µ / 2 –º–∏–Ω —Ö–æ–¥—å–±–∞.</p>
                    </div>
                    <div class="glass-card border-l-4 border-l-orange-400">
                        <h4 class="font-bold">3. –ë–µ—Ä–ø–∏ (3 –ø–æ–¥—Ö–æ–¥–∞)</h4>
                        <p class="text-xs text-gray-400">10 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π, –æ—Ç–¥—ã—Ö 30 —Å–µ–∫.</p>
                    </div>
                      <button class="btn-primary mt-4">–ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å</button>
                `;
            } else if (type === 'gym') {
                title.innerText = "–°–∏–ª–æ–≤–∞—è (–ó–∞–ª)";
                content.innerHTML = `
                    <div class="glass-card mb-4"><p>–ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ –≤—Å–µ —Ç–µ–ª–æ (Full Body).</p></div>
                    <div class="glass-card border-l-4 border-l-blue-400">
                        <h4 class="font-bold">1. –ñ–∏–º –ª–µ–∂–∞</h4>
                        <p class="text-xs text-gray-400">3 –ø–æ–¥—Ö–æ–¥–∞ –ø–æ 10 —Ä–∞–∑.</p>
                    </div>
                    <div class="glass-card border-l-4 border-l-blue-400">
                        <h4 class="font-bold">2. –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π</h4>
                        <p class="text-xs text-gray-400">3 –ø–æ–¥—Ö–æ–¥–∞ –ø–æ 12 —Ä–∞–∑.</p>
                    </div>
                      <button class="btn-primary mt-4">–ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å</button>
                `;
            } else if (type === 'yoga') {
                title.innerText = "–ô–æ–≥–∞";
                content.innerHTML = `
                    <div class="glass-card mb-4"><p>–ö–æ–º–ø–ª–µ–∫—Å –°—É—Ä—å—è –ù–∞–º–∞—Å–∫–∞—Ä (–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–æ–ª–Ω—Ü—É).</p></div>
                    <div class="glass-card border-l-4 border-l-purple-400"><h4 class="font-bold">1. –ü–æ–∑–∞ –≥–æ—Ä—ã</h4></div>
                    <div class="glass-card border-l-4 border-l-purple-400"><h4 class="font-bold">2. –ù–∞–∫–ª–æ–Ω –≤–ø–µ—Ä–µ–¥</h4></div>
                      <button class="btn-primary mt-4">–ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å</button>
                `;
            } else if (type === 'morning') {
                title.innerText = "–£—Ç—Ä–µ–Ω–Ω–∏–π –¢–æ–Ω—É—Å";
                content.innerHTML = `
                    <div class="glass-card mb-4"><p>–ó–∞—Ä—è–¥–∫–∞ –¥–ª—è –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞.</p></div>
                    <div class="glass-card border-l-4 border-l-teal-400"><h4 class="font-bold">1. –ü—Ä—ã–∂–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ (30 —Å–µ–∫)</h4></div>
                    <div class="glass-card border-l-4 border-l-teal-400"><h4 class="font-bold">2. –û—Ç–∂–∏–º–∞–Ω–∏—è (15 —Ä–∞–∑)</h4></div>
                    <div class="glass-card border-l-4 border-l-teal-400"><h4 class="font-bold">3. –ü–ª–∞–Ω–∫–∞ (45 —Å–µ–∫)</h4></div>
                      <button class="btn-primary mt-4">–ù–∞—á–∞—Ç—å</button>
                `;
            }
        }

        // --- LAB BOOKING ---
        function bookLab() {
            const toast = document.getElementById('toast');
            toast.innerText = "–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã! –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ó–∞–ø–∏—Å–∏¬ª.";
            toast.className = "show";
            setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
        }

    </script>
</body>
</html>
